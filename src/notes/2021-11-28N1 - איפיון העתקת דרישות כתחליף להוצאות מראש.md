---
layout: mynote
tags: [notes, expenses,po,purchasing, spec,  memo, op] 
created: 2021-12-12 17:13
modified: 2021-12-12 17:13
type: Document
title:  איפיון העתקת דרישות כתחליף להוצאות מראש 
---
Week Of: [[2021-12-12]]
[[2021-11-28]]


#  איפיון העתקת דרישות כתחליף להוצאות מראש


[[home]]/[[Open University]]/[[Memos]]

## רקע\תיאור
ישנם הסכמי תחזוקה מול ספקים שנכרתים לתקופות בנות מספר רב של חודשים וכך תשלומי הסכם התחזוקה מתפרס על מספר רב של שנות תקציב. 
המצב הינו בעייתי, מאחר ובמדה ויבצעו דרישה+הזמנה על כל ההסכם, ישוריין הכסף מראש והתקציב של השנה הנוכחית יקוצץ באופן משמעותי. 
לפני כשלש שנים, הוצע פתרון שבמסגרתו התאפשר להוציא את הסכום ששייך לשנות התקציב הבאות, על החשבון שמספרו 17303 והוא חשבון שהוצא מחוץ לבקרת התקציב. כך היה ניתן ליצור דרישות בעלות חשבונאות מפוצלת כאשר החלק ששייך לשנת התקציב הנוכחית משולם ממסגרת התקציב וזה ששייך לשנים הבאות נרשם, אך לא משוריין במסגרת תקציבית. 
בפרוס השנה התקציבית האחרונה (שנת תשפ"ב) התברר שקיימות הזמנות רכש רבות שבהן יש תשלום המשולם באופן **חודשי** לספקים. זה נאמר בזמנו שלא יתאפשר והעניין נשכח אך קיימים במערכת התקשרויות רבות מסוג זה ולכן יש למצוא פתרון לתהליך שיאפשר:
1. שיריון תקציבי רק עבור החלק היחסי של השנה התקציבית השוטפת.
2. פתרון טכני במערכת, כך שדלית לא תידרש מדי שנה להכנס ולבצע את כל תהליך הפקת הדרישה מחדש. 


## תיאור הפתרון
> שים לב: תנאי הבסיס והנחת היסוד הינה שיחידת המדה בכל הסכמי התחזוקה הינה "חודש". (כלומר, באם ההסכם הינו משולם רבעונית, יש לחלק את הסכום לפי תעריף **חודשי** ובשחרור לשחרר כמות של ארבעה חודשים ולא של רבעון)

כל הסכמי התחזוקה המשולמים חודשית בלבד יוזנו כהסכמי מסגרת במערכת. 
דלית תיצור דרישת שחרור אך ורק עם הכמות הנדרשת לשיריון לשנה התקציבית השוטפת.
בהסכם התחזוקה, יהיה שדה גמיש (DFF) שייקרא "הסכם תחזוקת מחשוב" והאופציות להזנה תהיינה: "כן\לא"   
אנו ניצור תוכנית שדלית תריץ מדי שנה ותאסוף את כל הדרישות שמיועדות להעתקה - לפי הסכם המסגרת. התוכנית תבצע העתקת הדרישות, כאשר בשדות הכמות יוזן החלק היחסי של השנה שבפתח.
לאחר הרצת התוכנית יווצרו דרישות רכש מועתקות עם החלק היחסי של אותה השנה. כאשר, לתיאור כותרת הדרישה תשורשר השנה התקציבית שעבורה הועתקה הדרישה. 
ההעתקה תתבצע כולל קישור הדרישות להסכם המסגרת וכולל הקבצים שצורפו לדרישה הראשונה שיצאה להסכם זה. העתקת הקבצים וקישור השורות להסכם יתבצע ברמת שורת הדרישה. (כלומר, קבצים שיצורפו לכותרת הדרישה ולהפצות הדרישה, לא יועתקו) 
 
דוגמא להתנהלות הלוגית של ההעתקה:
1. הוקם הסכם ל-36 חודשים ובכותרת ההסכם צויין כי זהו הסכם תחזוקת מחשוב.
2. בשנת תשפ"ב בחודש 12/2021 הוזנה דרישת שחרור ראשונה מן ההסכם. הדרישה תוזן כדרישה עם הכמות של 10 חודשים. (החישוב ייעשה באמצעות המחשבון, או באמצעות חישוב ידני חיצוני)  
3. בתחילת 10/2022 תיכנס דלית לתוכנית ההעתקה ותריץ אותה. תיווצר באופן אוטומטי דרישה זהה לקודמתה אך עם הכמות 12 חודשים.
4. כנ"ל ב- 10/2023
5. כשתכנס שוב דלית בשנת התקציב תשפ"ה, הדרישה שתיווצר תהיה רק עבור יתרת 2 החודשים שנותרו להסכם.

## איפיון טכני
### העתקת מסמכים
יש להסתמך על תוכנית ההעתקת ויצירת הדרישות הקיימת ולהוסיף לה את העתקת המסמכים מהדרישה הראשונה להסכם. 
דרישה הראשונה להסכם:
- אם ההסכם הינו "הסכם תחזוקת מחשוב" 
- אם הדרישה הינה דרישה שלא הוזנה ע"י תוכנית ההעתקה (אלא הוזנה ידנית ע"י משתמש)
- אז, יש להעתיק את הקבצים של שורות הדרישה הזו.
### חישוב החודשים לשנה הקרובה
יש לבצע את החישוב הבא:

```plsql
(CASE WHEN (NVL(QUANTITY_COMMITTED, 36) - NVL(QUANTITY_RELEASED, 0)) >= 12 THEN 12
        ELSE  
		  (NVL(QUANTITY_COMMITTED, 36) - NVL(QUANTITY_RELEASED, 0))
		  END)
 
```
הנתונים הנ"ל נמצאים במסך הבא (מסך הזמנות הרכש):
![[Pasted image 20211212185410.png]]

### פונקציית חישוב החודשים לשנה הנוכחית.
הפונקציה דלהלן נמצאת בחישוב של מחשבון ההוצאות מראש, באמצעותה ניתן לחשב את כמות החודשים שנותרו לשנה התקציבית הנוכחית.

````ad-code
```plsql
begin

  -- Call the procedure
  op_po_util_pkg.calc_enc_exp_vals(p_qty => :p_qty,
                                   p_from_date => :p_from_date,
                                   p_to_date => :p_to_date,
                                   p_enc_qty => :p_enc_qty,
                                   p_exp_qty => :p_exp_qty);
end;
```
````
### שדות הקישור להסכם מסגרת
לכאורה, במדה והשדות הללו ימולאו, הדרישה תהיה מקושרת להסכם. 
לשם בדיקת הקישור להסכם, נדרש לבצע אישור של הדרישה ולוודא שנוצר שחרור מההסכם באופן אוטומטי.
![[Pasted image 20211212171752.png]]



- [x] #task לעבור על זה שוב 📅 2021-12-13 ✅ 2021-12-14
 
 
#memo #op/memo
