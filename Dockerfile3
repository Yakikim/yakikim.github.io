FROM node:alpine3.12 as builder

COPY docker-eleventy/qemu-*-static /usr/bin/

COPY ./MySiteGithub/package*.json /app/
COPY ./MySiteGithub/node_modules/ /app/node_modules/

FROM builder

ARG VERSION=v2.0.0-canary.3
LABEL maintainer="Jay MOULIN <https://jaymoulin.me/femtopixel/docker-eleventy> <https://twitter.com/MoulinJay>"
LABEL version="${VERSION}"

RUN npm add -g npm @11ty/eleventy

WORKDIR /app

RUN npm install -g nodemon

EXPOSE 3000
EXPOSE 3001

CMD ["npx", "@11ty/eleventy", "--serve", "--port=3000"]